# Nixpacks configuration for Railway
# Required for WeasyPrint PDF generation

[phases.setup]
nixPkgs = [
  "python311",
  "gcc",
  "pango",
  "cairo",
  "fontconfig",
  "freetype",
  "harfbuzz",
  "libffi",
  "zlib"
]

# Install additional dependencies via apt for WeasyPrint
aptPkgs = [
  "libpango-1.0-0",
  "libpangocairo-1.0-0",
  "libgdk-pixbuf2.0-0",
  "libffi-dev",
  "shared-mime-info"
]

[phases.install]
cmds = ["pip install --upgrade pip", "pip install -r requirements.txt"]

[start]
cmd = "uvicorn app.main:app --host 0.0.0.0 --port ${PORT:-8000}"

[variables]
PYTHON_VERSION = "3.11"
